[supervisord]
# 日志级别 (debug, info, warn, error, crit)
loglevel=info
# 日志文件路径
logfile=/var/log/supervisord.log
# pid文件路径
pidfile=/var/run/supervisord.pid
# 子进程日志目录
childlogdir=/var/log/supervisor
# 禁用supervisord的Web界面
nodaemon=false
# 禁止自动启动子进程
autostart=true
# 自动重启失败的子进程
autorestart=true
# 子进程启动前等待时间
transition_probability=1

# 环境变量配置
[environment]
DISPLAY=%(ENV_DISPLAY)s
USER_DATA_DIR=%(ENV_USER_DATA_DIR)s
SCREEN_RES=%(ENV_SCREEN_RES)s
CHROMIUM_FLAGS=%(ENV_CHROMIUM_FLAGS)s

# Xvfb服务配置
[program:xvfb]
command=Xvfb %(ENV_DISPLAY)s -screen 0 1280x1024x24 -nolisten tcp -quiet
# 自动启动
autostart=true
# 自动重启
autorestart=true
# 启动失败后重试次数
startretries=3
# 启动前等待时间
startsecs=5
# 停止信号
stopsignal=TERM
# 停止等待时间
stopwaitsecs=10
# 日志输出
stdout_logfile=/var/log/supervisor/xvfb.log
stderr_logfile=/var/log/supervisor/xvfb.err.log
# 日志输出级别
stdout_logfile_maxbytes=50MB
stderr_logfile_maxbytes=50MB
# 日志文件数
stdout_logfile_backups=10
stderr_logfile_backups=10

# VNC服务配置
[program:x11vnc]
command=x11vnc -display %(ENV_DISPLAY)s -forever -nopw -quiet
# 自动启动
autostart=true
# 自动重启
autorestart=true
# 启动失败后重试次数
startretries=3
# 启动前等待时间
startsecs=5
# 停止信号
stopsignal=TERM
# 停止等待时间
stopwaitsecs=10
# 日志输出
stdout_logfile=/var/log/supervisor/x11vnc.log
stderr_logfile=/var/log/supervisor/x11vnc.err.log
# 日志输出级别
stdout_logfile_maxbytes=50MB
stderr_logfile_maxbytes=50MB
# 日志文件数
stdout_logfile_backups=10
stderr_logfile_backups=10
# 依赖于xvfb服务
requires=xvfb

# Fluxbox服务配置
[program:fluxbox]
command=fluxbox -display %(ENV_DISPLAY)s
# 自动启动
autostart=true
# 自动重启
autorestart=true
# 启动失败后重试次数
startretries=3
# 启动前等待时间
startsecs=5
# 停止信号
stopsignal=TERM
# 停止等待时间
stopwaitsecs=10
# 日志输出
stdout_logfile=/var/log/supervisor/fluxbox.log
stderr_logfile=/var/log/supervisor/fluxbox.err.log
# 日志输出级别
stdout_logfile_maxbytes=50MB
stderr_logfile_maxbytes=50MB
# 日志文件数
stdout_logfile_backups=10
stderr_logfile_backups=10
# 依赖于xvfb服务
requires=xvfb

# 事件监听配置
[eventlistener:processes]
command=supervisorctl status
# 事件类型
events=PROCESS_STATE_STARTING,PROCESS_STATE_STARTED,PROCESS_STATE_STOPPING,PROCESS_STATE_STOPPED
# 输出文件
stdout_logfile=/var/log/supervisor/events.log
stderr_logfile=/var/log/supervisor/events.err.log
# 日志输出级别
stdout_logfile_maxbytes=50MB
stderr_logfile_maxbytes=50MB
# 日志文件数
stdout_logfile_backups=10
stderr_logfile_backups=10